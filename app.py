from flask import Flask, request, render_template, redirect, url_for, flash, session
import sqlite3
from werkzeug.security import generate_password_hash, check_password_hash

app = Flask(__name__)
app.secret_key = 'BaNaNa_yo'  # Установите свой секретный ключ


@app.route("/")
def index():
    return render_template("Startpage.html")


@app.route("/login", methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        name = request.form.get('name')
        surname = request.form.get('surname')
        login = request.form.get('login')
        email = request.form.get('email')
        password = request.form.get('password')

        hashed_password = generate_password_hash(password)
        conn = sqlite3.connect('database (1).db')
        cursor = conn.cursor()
        cursor.execute('INSERT INTO users (name, surname, login, email, password) VALUES (?,?,?,?,?)',
                       (name, surname, login, email, hashed_password))
        conn.commit()
        conn.close()

    return render_template("login.html")


@app.route("/enter", methods=['GET', 'POST'])
def enter():
    if request.method == 'POST':
        login = request.form.get('login')
        email = request.form.get('email')
        password = request.form.get('password')

        conn = sqlite3.connect('database (1).db')
        cursor = conn.cursor()
        cursor.execute('SELECT * FROM users WHERE login=? AND email=?', (login, email))
        user = cursor.fetchone()
        print(f"Данные из базы: {user}")  # Вывод данных из базы для проверки
        conn.close()

        if user:
            # Проверяем пароль
            if check_password_hash(user[5], password):
                session['user_id'] = user[0]
                flash("Вход выполнен успешно!", "success")
                return redirect(url_for("Mainpage"))
            else:
                flash("Неправильный пароль.", "error")
        else:
            flash("Неправильный логин или email.", "error")
    return render_template("enter.html")


@app.route("/Mainpage")
def Mainpage():
    return render_template("Mainpage.html")


@app.route("/account")
def account():
    print(session['user_id'])
    if 'user_id' in session:
        conn = sqlite3.connect('database (1).db')
        cursor = conn.cursor()
        print(session['user_id'])
        cursor.execute('SELECT name, surname, login, email FROM users WHERE id = ?', (session['user_id'],))
        user = cursor.fetchone()
        conn.close()
        if user:
            return render_template('account.html', user=user)
        else:
            flash("Профиль не найден.", "error")
            return redirect(url_for('index'))
    else:
        flash("Вы не авторизованы.", "error")
        return redirect(url_for('index'))
places = {
    '1': {'title': 'Московский кремль', 'description': 'Московский Кремль — это исторический и архитектурный комплекс, расположенный в центре Москвы, Россию. Он служит официальной резиденцией Президента Российской Федерации и является объектом Всемирного наследия ЮНЕСКО. Кремль известен своими невероятными историческими и культурными памятниками, такими как соборы, церкви, стены и башни. Исторически Кремль был центром российской власти и играл важную роль в политической, религиозной и культурной жизни страны. Его стены, построенные в XV-XVI веках, представляют собой отличный пример русского архитектурного стиля. Внутри Кремля расположены такие известные здания, как Успенский собор, Архангельский собор, Благовещенский собор, а также Государственный исторический музей. Кремль также является популярным туристическим направлением, привлекающим миллионы посетителей как из России, так и из-за рубежа. Здесь можно увидеть великолепные архитектурные произведения, красивые площади и живописные виды на Москву-реку.'},
    '2': {'title': 'Большой театр', 'description': 'Большой театр (или Большой театр России) — один из самых известных театров в мире, расположенный в центре Москвы. Он был основан в 1776 году и стал символом русской культуры и искусства. Театр славится своими балетными и оперными постановками, а также великолепной архитектурой. Здание театра было реконструировано и восстановлено несколько раз из-за пожаров и войн. В 2011 году после капитального ремонта театр вновь открыл свои двери для зрителей. Архитектурный стиль театра можно отнести к классицизму с элементами барокко. Главный фасад украшен колоннами и величественным фронтоном. На крыше стоит знаковая скульптура «Алабе́рда» с четвёркой, что делает театр легко узнаваемым. Сегодня Большой театр продолжает привлекать внимание зрителей со всего мира, представляя уникальные спектакли и сохраняя традиции русского театрального искусства.'},
    '3': {'title': 'Московский зоопарк', 'description': 'Московский зоопарк — один из старейших зоопарков в России и Европы, открытый в 1864 году. Он расположен в центре Москвы, на берегу реки Фрунзенки. Зоопарк занимает территорию около 21 гектара, на которой проживают более 8000 животных, представляющих более 600 видов. Московский зоопарк активно участвует в программах по сохранению исчезающих видов и проводит научные исследования, образовательные программы для детей и взрослых. Зоопарк стал популярным местом не только для туристов, но и для местных жителей. Он включает в себя не только выставки с животными, но и специальные площадки для развлечений, кафе и магазины.'},
    '4': {'title': 'Школа акварели Сергея Андрияки', 'description': 'Школа акварелей Сергея Андрияки, основанная в 1993 году, является одной из самых известных учебных заведений в России, специализирующихся на обучении акварельной живописи. Сергей Андрияка, признанный мастер акварели и преподаватель, создал эту школу с целью передать знания и передвижническое искусство следующему поколению художников. Школа предлагает курсы для различных уровней подготовки — от новичков до профессионалов, охватывающие как теоретические, так и практические аспекты акварельной техники. Обучение включает изучение исторических аспектов акварельной живописи, работы с различными материалами, такими как акварельные краски, бумаги и кисти, а также освоение основ композиции, колорита и техники нанесения красок. Студенты школы получают уникальную возможность развить свои навыки, участвуя в мастер-классах, выездных пленэрах и выставках. Кроме того, школа регулярно организует выставки работ учеников, что позволяет молодым художникам продемонстрировать свои достижения широкой аудитории.'},
    '5': {'title': 'Собор Василия Блаженного', 'description': 'Собор Василия Блаженного, также известный как Покровский собор, является одной из самых известных достопримечательностей Москвы. Он расположен на Красной площади и был построен в 1555–1561 годах по приказу Ивана Грозного в честь победы над Казанским ханством. Собор славится своими яркими куполами и уникальной архитектурой, сочетая элементы восточного и русского стилей. Каждый из восьми куполов символизирует одного из мучеников, почитаемых в русской православной церкви. Сегодня собор является действующим храмом и музеем, привлекающим туристов со всего мира.'},
    '6': {'title': 'Москва-Сити', 'description': 'Москва-Сити — это деловой район в центре Москвы, который стал символом современной архитектуры города. Строительство района началось в конце 1990-х годов, и на сегодняшний день он включает в себя несколько высоких небоскребов, среди которых знаменитые «Башня Федерация», «Восточная Европа», «Космос» и другие. Основной целью создания Москва-Сити было создание нового финансового и делового центра, повышение инвестиционной привлекательности столицы, а также улучшение деловой инфраструктуры. В рамках проекта планировалось создание офисных, жилых, гостиничных и торговых комплексов.'},
    '7': {'title': 'Северный Речной Вокзал', 'description': 'Северный Речной Вокзал — один из самых известных речных вокзалов в Москве, открытый в 1937 году. Это уникальное сооружение сочетает в себе элементы архитектуры в стиле сталинского неоклассического направления и популярного в то время стиля "арт-деко". Вокзал стал важным транспортным узлом для речных пассажирских перевозок, а также местом отдыха и развлечений для москвичей и туристов. Северный Речной Вокзал находится на берегу реки Москвы и предлагает услуги по подписке на круизы по рекам и каналам города. Это также памятник архитектуры, который включает в себя оригинальную архитектуру, фонтаны, площади и красивые пейзажи. Вокзал стал не только транспортной развязкой, но и важной частью культурной жизни столицы.'},
    '8': {'title': 'Петровский путевой дворец', 'description': 'Петровский путевой дворец — это историческое здание, расположенное в Москве, построенное в стиле русского барокко. Дворец был возведен в конце XVII века по распоряжению Петра I как гостиница для царских путешествующих и иностранных гостей, прибывающих в Москву. Архитектором дворца считается Иван Зарудный. Здание имеет два этажа и украшается красивыми декоративными элементами, которые отражают стиль того времени. Дворец использовался не только как место для остановки высокопоставленных гостей, но и для проведения официальных приемов. В настоящее время Петровский путевой дворец является музейным комплексом и культурным центром, где проводятся выставки и другие мероприятия.'},
    '9': {'title': 'Останкинская телебашня', 'description': 'Останкинская телебашня — это одна из самых высоких и известных телебашен в мире, расположенная в Москве. Она была построена в 1967 году как объект для передачи телевидения и радиосигналов. Высота Останкинской телебашни составляет 540 метров, что делает её самой высокой в Европе. Башня является архитектурным памятником и символом Москвы. На высоте 337 метров расположена смотровая площадка, откуда открывается великолепный вид на город. Останкинская телебашня также имеет ресторан и несколько научно-исследовательских лабораторий. В 2005 году башня была повреждена в результате пожара, но затем восстановлена и вновь открыта для посетителей.'},
    '10': {'title': 'Музей космонавтики', 'description': 'Музей космонавтики, расположенный на территории ВДНХ (Выставка достижений народного хозяйства), открыт в 1964 году и является одним из ключевых музеев в России, посвящённых достижениям в области космонавтики. В музее представлена обширная экспозиция, охватывающая важнейшие моменты в истории освоения космоса. Здесь можно увидеть оригинальные образцы космических аппаратов, спутников, а также множество экспонатов, связанных с деятельностью советской и российской космонавтики. Главной гордостью музея является макет ракеты-носителя "Союз", а также 10-метровый оригинал "Востока", первого космического корабля, на котором совершил полет Юрий Гагарин. Музей также проводит образовательные программы, экскурсии и научные семинары, что делает его важной площадкой для популяризации космонавтики и науки в целом.'},
    '11': {'title': 'Москвариум', 'description': 'Москвариум — это один из крупнейших аквариумов в Европе, расположенный в Москве на ВДНХ. Москвариум был открыт в 2015 году и занимает площадь около 30 000 квадратных метров. Он содержит более 800 видов живых существ, включая рыбы, морских млекопитающих, рептилий и беспозвоночных. Основной целью Москвариума является не только развлечение посетителей, но и просвещение о важности охраны окружающей среды и сохранения водных экосистем. В Москвариуме можно увидеть аквариумы с экзотическими морскими обитателями, интерактивные экспозиции и шоу с участием животных, таких как дельфины и морские львы. Также здесь проводятся образовательные программы и лекции для широкой аудитории и школьников.'},
    '12': {'title': 'Усадьба Грачёвка', 'description': 'Усадьба Грачёвка расположена в Подмосковье и относится к архитектурным памятникам XVIII-XIX веков. Она представляет собой пример усадебного строительства той эпохи и включает в себя жилой дом, парк и хозяйственные постройки. Строение отличается характерными чертами русского классицизма. Усадьба была построена для дворянского семейства, и её территория занимает живописные участки с прудами, садами и парками. Усадьба Грачёвка имеет интересную историю, связанную с культурной и общественной жизнью своих хозяев, они активно участвовали в жизни общества того времени. В разные эпохи усадьба служила местом встреч известных личностей, что придает ей дополнительную историческую ценность.'},
    '13': {'title': 'Музей оружия', 'description': 'Музей оружия, расположенный в Москве, представляет собой уникальное заведение, посвященное истории и развитию оружия разных эпох и народов. В коллекции музея есть как холодное, так и огнестрельное оружие, включая экспонаты, относящиеся к различным военным конфликтам и историческим событиям. Музей предлагает посетителям разнообразные выставки и экскурсии, где можно узнать не только о самих образцах оружия, но и о контексте их использования и производстве.'},
    '14': {'title': 'Парк Сокольники', 'description': 'Парк Сокольники — это один из крупнейших парков Москвы, расположенный на северо-востоке столицы. Он занимает площадь более 600 гектаров и предоставляет разнообразные возможности для рекреационного отдыха, спорта и культурных мероприятий. Парк был основан в 1778 году и представляет собой уникальное сочетание исторической архитектуры и природного ландшафта.'},
}


@app.route('/information')
def information():
    id = request.args.get('id')
    if id and id in places:
        place = places[id]
        return render_template('information.html', title=place['title'], description=place['description'])
    else:
        return 'Информация не найдена', 404


@app.route("/test", methods=['GET', 'POST'])
def test():
    return render_template("test.html")


if __name__ == '__main__':
    app.run(port=8080, host='127.0.0.1')